# Cloudflare Tunnel Configuration
# This allows Cloudflare to proxy traffic to your Replit app without a custom domain
# 
# Setup Instructions:
# 1. Install cloudflared: curl -L --output cloudflared.deb https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb && sudo dpkg -i cloudflared.deb
# 2. Login to Cloudflare: cloudflared tunnel login
# 3. Create tunnel: cloudflared tunnel create mtg-app
# 4. Update the tunnel ID below with your actual tunnel ID
# 5. Run: cloudflared tunnel --config cloudflare-tunnel.yml run

tunnel: ${CLOUDFLARE_TUNNEL_ID}
credentials-file: /home/runner/.cloudflared/${CLOUDFLARE_TUNNEL_ID}.json

# Route all traffic to your Replit app
ingress:
  - hostname: ${CLOUDFLARE_TUNNEL_HOSTNAME}
    service: http://localhost:5000
    # Enable Cloudflare features
    originRequest:
      # Disable buffering for real-time features
      noTLSVerify: false
      connectTimeout: 30s
      tlsTimeout: 10s
      tcpKeepAlive: 30s
      keepAliveConnections: 100
      keepAliveTimeout: 90s
      httpHostHeader: localhost:5000

  # Catch-all rule (required)
  - service: http_status:404

# For Custom Domain Setup (Future):
# Replace the hostname above with your custom domain like:
# - hostname: yourmtgapp.com
# - hostname: "*.yourmtgapp.com"  # For subdomains
# 
# Then configure DNS in Cloudflare dashboard:
# - A record: yourmtgapp.com -> TUNNEL (proxied)
# - CNAME: www -> yourmtgapp.com (proxied)